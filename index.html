<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: rgb(215, 197, 231);
    display: flex;
    flex-direction: column;
  }

  #titleCont {
    width: 500px;
    justify-content: center;
    display: flex;
  }

  #title {
    display: inline-block;
    font-family: "Lilita One", sans-serif;
    font-weight: 400;
    font-style: normal;
    color: deeppink;
    -webkit-text-stroke: 1px black;

  }

  #chart {
    width: 500px;
    height: 500px;
  }
</style>

<body>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Quattrocento+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Sacramento&display=swap"
    rel="stylesheet">

  <div id="titleCont">
    <h1 id="title">Star Signs by Team</h1>
  </div>
  <div id="chart">
    <canvas id="myChart" width="400" height="400"></canvas>
  </div>
  <script>

    fetch('https://raw.githubusercontent.com/lilygarfinkel/bsbl/main/bbl.json').then(response => response.json()).then(data => {
      fetch('https://raw.githubusercontent.com/lilygarfinkel/bsbl/main/byteam.json').then(response => response.json()).then(teamdata => {


        var signs = [];
        var total = [];
        var counts = [];
        s = []

        var c = 0;
        for (var sign in data) {
          s.push(sign)
          signs.push({ 'sign': sign, 'teams': {} })
          for (var team in data[sign]) {
            counts.push({ team, 'count': data[sign][team] })
          }
          signs[c]['teams'] = counts;
          c += 1;
          counts = []
        }

        totals = []
        teams = []
        count = []
        c = 0;

        for (team in teamdata) {
          console.log(team)
          teams.push({ 'team': team, 'data': {} })
          for (sign in teamdata[team]) {
            count.push(teamdata[team][sign])
            teams[c]['data'] = count;
          }
          c += 1;
          count = []
        }

        var angels = teams[0].data
        var astros = teams[1].data
        var athletics = teams[2].data
        var bluejays = teams[3].data
        var braves = teams[4].data
        var brewers = teams[5].data
        var cardinals = teams[6].data
        var cubs = teams[7].data
        var dbacks = teams[8].data
        var dodgers = teams[9].data
        var giants = teams[10].data
        var guardians = teams[11].data
        var mariners = teams[12].data
        var marlins = teams[13].data
        var mets = teams[14].data
        var nationals = teams[15].data
        var orioles = teams[16].data
        var padres = teams[17].data
        var phillies = teams[18].data
        var pirates = teams[19].data
        var rangers = teams[20].data
        var rays = teams[21].data
        var redsox = teams[22].data
        var reds = teams[23].data
        var rockies = teams[24].data
        var royals = teams[25].data
        var tigers = teams[26].data
        var twins = teams[27].data
        var whitesox = teams[28].data
        var yankees = teams[29].data


        const canvas = document.getElementById('myChart');

        new Chart(canvas, {
          type: 'bar',
          data: {
            labels: s,
            datasets: [{
              label: 'angels',
              data: angels,
              stack: 'stack 0',
              backgroundColor: '#BA0021'
            },
            {
              label: 'astros',
              data: astros,
              stack: 'stack 0',
              backgroundColor: '#EB6E1F'
            },
            {
              label: 'athletics',
              data: athletics,
              stack: 'stack 0',
              backgroundColor: '#003831'
            },
            {
              label: 'blue jays',
              data: bluejays,
              stack: 'stack 0',
              backgroundColor: '#134A8E'
            },
            {
              label: 'braves',
              data: braves,
              stack: 'stack 0',
              backgroundColor: '#CE1141'
            },
            {
              label: 'brewers',
              data: brewers,
              stack: 'stack 0',
              backgroundColor: '#FFC52F'
            },
            {
              label: 'cardinals',
              data: cardinals,
              stack: 'stack 0',
              backgroundColor: '#C41E3A'
            },
            {
              label: 'cubs',
              data: cubs,
              stack: 'stack 0',
              backgroundColor: '#0E3386'
            },
            {
              label: 'diamondbacks',
              data: dbacks,
              stack: 'stack 0',
              backgroundColor: '#A71930'
            },
            {
              label: 'dodgers',
              data: dodgers,
              stack: 'stack 0',
              backgroundColor: '#005A9C'
            },
            {
              label: 'giants',
              data: giants,
              stack: 'stack 0',
              backgroundColor: '#FD5A1E'
            },
            {
              label: 'guardians',
              data: guardians,
              stack: 'stack 0',
              backgroundColor: '#E50022'
            },
            {
              label: 'mariners',
              data: mariners,
              stack: 'stack 0',
              backgroundColor: '#0C2C56'
            },
            {
              label: 'marlins',
              data: marlins,
              stack: 'stack 0',
              backgroundColor: '#00A3E0'
            },
            {
              label: 'mets',
              data: mets,
              stack: 'stack 0',
              backgroundColor: '#FF5910'
            },
            {
              label: 'nationals',
              data: nationals,
              stack: 'stack 0',
              backgroundColor: '#AB0003'
            },
            {
              label: 'orioles',
              data: orioles,
              stack: 'stack 0',
              backgroundColor: '#DF4601'
            },
            {
              label: 'padres',
              data: padres,
              stack: 'stack 0',
              backgroundColor: '#2F241D'
            },
            {
              label: 'phillies',
              data: phillies,
              stack: 'stack 0',
              backgroundColor: '#E81828'
            },
            {
              label: 'pirates',
              data: pirates,
              stack: 'stack 0',
              backgroundColor: '#FDB827'
            },
            {
              label: 'rangers',
              data: rangers,
              stack: 'stack 0',
              backgroundColor: '#003278'
            },
            {
              label: 'red sox',
              data: redsox,
              stack: 'stack 0',
              backgroundColor: '#BD3039'
            },
            {
              label: 'reds',
              data: reds,
              stack: 'stack 0',
              backgroundColor: '#C6011F'
            },
            {
              label: 'rockies',
              data: rockies,
              stack: 'stack 0',
              backgroundColor: '#330072'
            },
            {
              label: 'royals',
              data: royals,
              stack: 'stack 0',
              backgroundColor: '#004687'
            },
            {
              label: 'tigers',
              data: tigers,
              stack: 'stack 0',
              backgroundColor: '#FA4616'
            },
            {
              label: 'twins',
              data: twins,
              stack: 'stack 0',
              backgroundColor: '#002B5C'
            },
            {
              label: 'white sox',
              data: whitesox,
              stack: 'stack 0',
              backgroundColor: '#C4CED4'
            },
            {
              label: 'yankees',
              data: yankees,
              stack: 'stack 0',
              backgroundColor: '#0C2340',
            }
            ]
          },

          options: {
            tooltip: {
              callbacks: {
                afterbody: function (items) {
                  return 'Total: ' + items.reduce((a, b) => a + b.parsed.y, 0)

                }
              }
            },
            // parsing: {
            //   xAxisKey: teams.team,
            //   yAxisKey: teams.count
            // },
            scales: {
              x: { stacked: true },
              y: { stacked: true }
            },
            plugins: {
              legend: {
                display: false,
                labels: {
                  boxWidth: 15,
                  boxHeight: 15,
                }


              }
            },

          }

        }
        );
      })
    }).catch(error => console.error(error));
  </script>
</body>